#include <GL/glut.h>
#include <iostream>
#include <cmath>

float x1u, y1u, x2u, y2u, x3u, y3u, x4u, y4u;  // Square vertices
float tx, ty;         // Translation
float angleDeg;       // Rotation angle
float sx, sy;         // Scaling
int reflectionType;   // Reflection option
float shx, shy;       // Shearing factors

void display() {
    glClear(GL_COLOR_BUFFER_BIT);

    // -------------------------------
    // 1. ORIGINAL SQUARE (RED)
    // -------------------------------
    glColor3f(1.0, 0.0, 0.0);
    glBegin(GL_QUADS);
        glVertex2f(x1u, y1u);
        glVertex2f(x2u, y2u);
        glVertex2f(x3u, y3u);
        glVertex2f(x4u, y4u);
    glEnd();


    // -------------------------------
    // 2. TRANSLATED SQUARE (BLUE)
    // -------------------------------
    glColor3f(0.0, 0.0, 1.0);
    glBegin(GL_QUADS);
        glVertex2f(x1u + tx, y1u + ty);
        glVertex2f(x2u + tx, y2u + ty);
        glVertex2f(x3u + tx, y3u + ty);
        glVertex2f(x4u + tx, y4u + ty);
    glEnd();


    // -------------------------------
    // 3. ROTATED SQUARE (GREEN)
    // -------------------------------
    float theta = angleDeg * M_PI / 180.0;
    float cosT = cos(theta), sinT = sin(theta);

    auto ROT = [&](float x, float y, float &xr, float &yr){
        xr = x*cosT - y*sinT;
        yr = x*sinT + y*cosT;
    };

    float x1r,y1r,x2r,y2r,x3r,y3r,x4r,y4r;
    ROT(x1u,y1u,x1r,y1r);  ROT(x2u,y2u,x2r,y2r);
    ROT(x3u,y3u,x3r,y3r);  ROT(x4u,y4u,x4r,y4r);

    glColor3f(0.0, 0.7, 0.0);
    glBegin(GL_QUADS);
        glVertex2f(x1r,y1r);
        glVertex2f(x2r,y2r);
        glVertex2f(x3r,y3r);
        glVertex2f(x4r,y4r);
    glEnd();


    // -------------------------------
    // 4. SCALED SQUARE (MAGENTA)
    // -------------------------------
    glColor3f(1.0, 0.0, 1.0);
    glBegin(GL_QUADS);
        glVertex2f(x1u * sx, y1u * sy);
        glVertex2f(x2u * sx, y2u * sy);
        glVertex2f(x3u * sx, y3u * sy);
        glVertex2f(x4u * sx, y4u * sy);
    glEnd();


    // -------------------------------
    // 5. REFLECTED SQUARE (CYAN)
    // -------------------------------
    float xr1,yr1,xr2,yr2,xr3,yr3,xr4,yr4;

    switch(reflectionType){
        case 1: // X-axis
            xr1=x1u; yr1=-y1u;   xr2=x2u; yr2=-y2u;
            xr3=x3u; yr3=-y3u;   xr4=x4u; yr4=-y4u;
            break;

        case 2: // Y-axis
            xr1=-x1u; yr1=y1u;   xr2=-x2u; yr2=y2u;
            xr3=-x3u; yr3=y3u;   xr4=-x4u; yr4=y4u;
            break;

        case 3: // Origin
            xr1=-x1u; yr1=-y1u;  xr2=-x2u; yr2=-y2u;
            xr3=-x3u; yr3=-y3u;  xr4=-x4u; yr4=-y4u;
            break;

        case 4: // Line y=x
            xr1=y1u; yr1=x1u;   xr2=y2u; yr2=x2u;
            xr3=y3u; yr3=x3u;   xr4=y4u; yr4=x4u;
            break;
    }

    glColor3f(0.0, 1.0, 1.0);
    glBegin(GL_QUADS);
        glVertex2f(xr1, yr1);
        glVertex2f(xr2, yr2);
        glVertex2f(xr3, yr3);
        glVertex2f(xr4, yr4);
    glEnd();


    // -------------------------------
    // 6. SHEARED SQUARE (YELLOW)
    // -------------------------------
    auto SH = [&](float x, float y, float &xh, float &yh){
        xh = x + shx * y;
        yh = y + shy * x;
    };

    float x1h,y1h,x2h,y2h,x3h,y3h,x4h,y4h;
    SH(x1u,y1u,x1h,y1h);
    SH(x2u,y2u,x2h,y2h);
    SH(x3u,y3u,x3h,y3h);
    SH(x4u,y4u,x4h,y4h);

    glColor3f(1.0, 1.0, 0.0);
    glBegin(GL_QUADS);
        glVertex2f(x1h,y1h);
        glVertex2f(x2h,y2h);
        glVertex2f(x3h,y3h);
        glVertex2f(x4h,y4h);
    glEnd();


    glFlush();
}

void init(){
    glClearColor(1,1,1,1);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluOrtho2D(-20,20,-20,20);
}

int main(int argc,char** argv){

    std::cout << "Enter 4 points of the square (x y):\n";
    std::cin >> x1u >> y1u;
    std::cin >> x2u >> y2u;
    std::cin >> x3u >> y3u;
    std::cin >> x4u >> y4u;

    std::cout << "Enter translation (Tx Ty): ";
    std::cin >> tx >> ty;

    std::cout << "Enter rotation angle (degrees): ";
    std::cin >> angleDeg;

    std::cout << "Enter scaling (Sx Sy): ";
    std::cin >> sx >> sy;

    std::cout << "\nReflection Type:\n";
    std::cout << "1. X-axis\n2. Y-axis\n3. Origin\n4. y=x\nChoice: ";
    std::cin >> reflectionType;

    std::cout << "Enter shearing (shx shy): ";
    std::cin >> shx >> shy;


    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);
    glutInitWindowSize(700,700);
    glutCreateWindow("2D Transformations on Square - GLUT");

    init();
    glutDisplayFunc(display);
    glutMainLoop();
    return 0;
}
